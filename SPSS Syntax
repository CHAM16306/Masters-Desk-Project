
DATASET ACTIVATE DataSetOriginal.

# Codebook to look at the data

CODEBOOK  cohort_AD_control [n]
  /VARINFO POSITION LABEL TYPE FORMAT MEASURE ROLE VALUELABELS MISSING ATTRIBUTES
  /OPTIONS VARORDER=VARLIST SORT=ASCENDING MAXCATS=200
  /STATISTICS COUNT PERCENT MEAN STDDEV QUARTILES.

#########################################################################################

# Recoding into binary variables (Transform -> Recode into different variables)

DATASET ACTIVATE DataSetOriginal.

RECODE SEX ('F'=1) ('M'=0) INTO sex_rec.
VARIABLE LABELS  sex_rec 'sex_rec'.
EXECUTE.

RECODE cohort_htn ('1. Control'=0) ('2. AD'=1) ('3. Mixed'=-1) ('4. VaD'=-2) 
INTO cohort_rec.
VARIABLE LABELS cohort_rec 'Hypertension cohort group_rec'.
EXECUTE.

RECODE htn ('No'=0) ('Yes'=1) 
INTO htn_rec.
VARIABLE LABELS  htn_rec 'Hypertension ever in life'.
EXECUTE.

RECODE htn_diag ('No'=0) ('Yes'=1) 
INTO htn_diag_rec.
VARIABLE LABELS  htn_diag_rec 'Hypertension diagnosed clinically during life'.
EXECUTE.

RECODE htn_midlife ('No'=0) ('Yes'=1) 
INTO htn_midlife_rec.
VARIABLE LABELS  htn_midlife_rec 'Hypertension in midlife'.
EXECUTE.

RECODE latelife_bp ('No'=0) ('Yes'=1) 
INTO latelife_bp_rec.
VARIABLE LABELS  latelife_bp_rec 'Late-life bp measurements available'.
EXECUTE.

DATASET ACTIVATE DataSet4.
RECODE AHT_anyreason ('No'=0) ('Yes'=1) INTO AHT_anyreason_rec.
VARIABLE LABELS  AHT_anyreason_rec 'antihypertensives - any type for any reason'.
EXECUTE.

RECODE AHT_reason ('No AHT'=-1) ('AHT for HTN'=1) ('not for HTN'=0) INTO AHT_reason_rec.
VARIABLE LABELS  AHT_reason_rec 'antihypertensives - reason if for/not for treatment of HTN'.
EXECUTE.

RECODE SVD_frontal SVD_parietal CAA_frontal CAA_parietal (0=0) (1=0) (2=1) (3=1) INTO 
    SVD_frontal_rec2 SVD_parietal_rec2 CAA_frontal_rec2 CAA_parietal_rec2.
EXECUTE.

#########################################################################################
#########################################################################################

#TASK 1: Summary demographic and neuropathological data of the hypertensive and normotensive AD brains

#########################################################################################
#########################################################################################

#Cohort summary of HT ever in life

DATASET ACTIVATE DataSetOriginal.
#Original, non-split data

#For the numbers per sex and total

CROSSTABS
  /TABLES=  AHT_anyreason_rec BY sex_rec BY cohort_AD_control BY htn_rec 
  /FORMAT=AVALUE TABLES
  /STATISTICS=CHISQ 
  /CELLS=COUNT
  /COUNT ROUND CELL
  /BARCHART.


#For mean age and mean PMDELAY 

DATASET ACTIVATE DataSetHT.
#Split by HT

SORT CASES  BY htn_rec.
SPLIT FILE LAYERED BY htn_rec.

  FREQUENCIES VARIABLES=PMDELAY AGE
  /FORMAT=NOTABLE
  /STATISTICS=STDDEV MINIMUM MAXIMUM MEAN MEDIAN
  /ORDER=ANALYSIS.


DATASET ACTIVATE DataSetHT_AD.
#Split by HT and AD

SORT CASES  BY htn_rec cohort_AD_control.
SPLIT FILE LAYERED BY htn_rec cohort_AD_control.

  FREQUENCIES VARIABLES=PMDELAY AGE
  /FORMAT=NOTABLE
  /STATISTICS=STDDEV MINIMUM MAXIMUM MEAN MEDIAN
  /ORDER=ANALYSIS.


DATASET ACTIVATE DataSetHT_AHT.
#Split by HT and AHT

SORT CASES  BY htn_ec AHT_anyreason_rec.
SPLIT FILE LAYERED BY htn_rec AHT_anyreason_rec.

FREQUENCIES VARIABLES=AGE PMDELAY
  /STATISTICS=STDDEV MEAN MEDIAN
  /ORDER=ANALYSIS.

#########################################################################################

#Cohort summary of mid-life HT

DATASET ACTIVATE DataSetOriginal.
#Original, non-split data

#For the numbers per sex and total

CROSSTABS
  /TABLES=  AHT_anyreason_rec BY sex_rec BY cohort_AD_control BY htn_midlife_rec 
  /FORMAT=AVALUE TABLES
  /STATISTICS=CHISQ 
  /CELLS=COUNT
  /COUNT ROUND CELL
  /BARCHART.

#For mean age and mean PMDELAY 

DATASET ACTIVATE DataSetMidHT.
#Split by Mid-lifeHT

SORT CASES  BY htn_midlife_rec.
SPLIT FILE LAYERED BY htn_midlife_rec.

  FREQUENCIES VARIABLES=PMDELAY AGE
  /FORMAT=NOTABLE
  /STATISTICS=STDDEV MINIMUM MAXIMUM MEAN MEDIAN
  /ORDER=ANALYSIS.


DATASET ACTIVATE DataSetMidHT_AD.
#Split by mid-life HT and AD

SORT CASES  BY htn_midlife_rec cohort_AD_control.
SPLIT FILE LAYERED BY htn_midlife_rec cohort_AD_control.

  FREQUENCIES VARIABLES=PMDELAY AGE
  /FORMAT=NOTABLE
  /STATISTICS=STDDEV MINIMUM MAXIMUM MEAN MEDIAN
  /ORDER=ANALYSIS.


DATASET ACTIVATE DataSetMidHT_AHT.
#Split by midlife HT and AHT

SORT CASES  BY htn_midlife_rec AHT_anyreason_rec.
SPLIT FILE LAYERED BY htn_midlife_rec AHT_anyreason_rec.

FREQUENCIES VARIABLES=AGE PMDELAY
  /STATISTICS=STDDEV MEAN MEDIAN
  /ORDER=ANALYSIS.

#########################################################################################

#Are there sig- differences between age, sex or PMDELAY

DATASET ACTIVATE DataSetOriginal.

EXAMINE VARIABLES=AGE PMDELAY sex_rec
  /PLOT BOXPLOT STEMLEAF NPPLOT
  /COMPARE GROUPS
  /STATISTICS DESCRIPTIVES
  /CINTERVAL 95
  /MISSING LISTWISE
  /NOTOTAL.
  
#sig. i.e. no normal distribrution = non-parametric test

NPAR TESTS
  /M-W= AGE PMDELAY sex_rec BY htn_rec (0 1)
  /STATISTICS=DESCRIPTIVES QUARTILES
  /MISSING ANALYSIS.

NPAR TESTS
  /M-W= AGE PMDELAY sex_rec BY htn_midlife_rec (0 1)
  /STATISTICS=DESCRIPTIVES QUARTILES
  /MISSING ANALYSIS.

#No sig. differences between HT and norm (ever in life or midlife)

#########################################################################################

#Differences in age, post-mortem delay and sex between 
#treated and untreated cases, and between control and AD cases

DATASET ACTIVATE DataSetHT.
#HT only

NPAR TESTS
  /M-W= AGE PMDELAY sex_rec BY AHT_anyreason_rec (0 1)
  /STATISTICS=DESCRIPTIVES QUARTILES
  /MISSING ANALYSIS.

NPAR TESTS
  /M-W= AGE PMDELAY sex_rec BY cohort_AD_control (0 1)
  /STATISTICS=DESCRIPTIVES QUARTILES
  /MISSING ANALYSIS.


DATASET ACTIVATE DataSetMidHT.
#Midlife HT only
#sig. i.e. no normal distribrution

NPAR TESTS
  /M-W= AGE PMDELAY sex_rec BY AHT_anyreason_rec (0 1)
  /STATISTICS=DESCRIPTIVES QUARTILES
  /MISSING ANALYSIS.

NPAR TESTS
  /M-W= AGE PMDELAY sex_rec BY cohort_AD_control (0 1)
  /STATISTICS=DESCRIPTIVES QUARTILES
  /MISSING ANALYSIS.

#########################################################################################

#Proporion of HT and norm within AD and control within

DATASET ACTIVATE DataSetOriginal.

CROSSTABS
  /TABLES= cohort_AD_control BY htn_diag_rec htn_midlife_rec htn_rec
 /FORMAT=AVALUE TABLES
  /STATISTICS=CHISQ 
  /CELLS=COUNT ROW PROP 
  /COUNT ROUND CELL
  /BARCHART.

